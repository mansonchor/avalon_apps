define("frame/page",["ua","base_package"],function(e,t){var i=e("zepto");e("ua"),e("hammer")(i),i(document.body).hammer({swipe_velocity:.2}),t.new_page=function(e){var t=this;return{route:e.route,view:function(){return t.new_view(e)}}},t.new_view=function(t){var i=e("backbone"),a=i.View.extend({tagName:"div",className:"apps_page",title:t.title,manual_title:t.manual_title,dom_not_cache:t.dom_not_cache,transition_type:t.transition_type,ignore_exist:t.ignore_exist,without_his:t.without_his||!1,initialize:function(){"function"==typeof t.initialize&&t.initialize.call(this)},events:t.events,render:t.render,page_show:t.page_show,page_before_show:t.page_before_show,page_back_show:t.page_back_show,page_init:t.page_init,window_change:t.window_change,page_before_hide:t.page_before_hide,page_hide:t.page_hide,page_lock:!1});return new a}}),define("frame/page_control",["base_package","ua"],function(e,t){function i(){var e=location.href,t=b.length;if(t>1){var i=b[t-2];return"forward"!=p&&i==e?!0:!1}return!1}function a(e,t,i,a){var o,s,d=this,l="400ms",r="400ms",_="400ms",c="ease";switch(I&&m.isAndroid&&(i="none"),"function"==typeof t.page_before_show&&t.page_before_show.call(d,t,v,w),e&&"function"==typeof e.page_before_hide&&e.page_before_hide.call(d,e),i){case"slide":a?(o="slideinfromleft",s="slideoutfromright"):(o="slideinfromright",s="slideoutfromleft"),animation_timing_function=c,animation_duration=l;break;case"slide_reverse":a?(o="slideinfromleft",s="slideoutfromright"):(o="slideinfromleft",s="slideoutfromright"),animation_timing_function=c,animation_duration=l;break;case"slideup":a?(o="slideupinfromtop",s="slideupoutfrombottom"):(o="slideupinfrombottom",s="slideupoutfromtop"),animation_timing_function=c,animation_duration=r;break;case"fade":o="fadein",s="fadeout",animation_timing_function=c,animation_duration=_;break;default:o="none",s="none",animation_timing_function=c,animation_duration="10ms"}if(j=!0,o){var p=t.el;if(y=t,p.style.webkitAnimationDuration=animation_duration,p.style.webkitAnimationTimingFunction=animation_timing_function,p.style.visibility="visible",p.style.webkitAnimationName=o,e){var h=e.el;x=e,h.style.webkitAnimationDuration=animation_duration,h.style.webkitAnimationTimingFunction=animation_timing_function,h.style.webkitAnimationName=s}else j=!1;setTimeout(function(){"function"==typeof y.page_back_show&&k&&y.page_back_show.call(d,y,v,w),"function"==typeof y.page_show&&y.page_show.call(d,y,v,w),n()},parseInt(animation_duration))}}function n(){j=!1;var e=this,t=x.el;y.el,1!=y.manual_title&&(document.title=y.title?y.title:d),t&&(c(t).css({top:"-3000px"}),"function"==typeof x.page_hide&&x.page_hide.call(e),1==x.dom_not_cache&&k&&x&&x.remove(),y.without_his&&x&&x.remove()),h=null,p=null,k=null}var o,s,d,l,r,_=e("backbone"),c=e("zepto"),m=e("ua"),p=null,h=null,u={},f=[],g=null,v=[],b=[],w={},y={},x={},k=null,$=null,z=null,j=!1,C=!1,I=!0,T=_.Router.extend({}),q=new T;t.init=function(e,t){var i=this,t=t||{};s=t.default_index_route||"",d=t.default_title||"",l=t.before_route||"",r=t.after_route||"",o=e,q.route("","",function(){i.navigate_to_page(s)})},t.route_start=function(){_.history.start()},t.navigate_to_page=function(e,t,i,a){if(!j){w=t,p="forward";var i=null==i?!1:i;$=i,z=null==a?!1:a,q.navigate(e,{trigger:!0,replace:i})}},t.back=function(){if(!j){if(1>=f.length)return""!=s&&(this.navigate_to_page(s),setTimeout(function(){x.remove()},1e3)),!1;p="backward",window.history.back()}},t.page_history=function(){return b},t.window_change_page_triger=function(){"function"==typeof y.window_change&&y.window_change.call(this,y)},t.return_current_page_view=function(){return y},t.lock_page=function(){C=!0},t.unlock_page=function(){C=!1},t.page_lock_status=function(){return C},t.page_transit_status=function(){return j};var N=1e4;t.add_page=function(e){var t=this,n=e.route||{};for(key in n)q.route(key,n[key],function(n,s,d){if(!j){v=[],v.push(n),v.push(s),v.push(d);var _=location.href;"function"==typeof l&&l.call(t);var m=!1,m=c(o).find('[page-url="'+_+'"]').length;if(k=i()){f.pop();var p=g,h=f[f.length-1];if(m>0){var y=p.transition_type;a(p,h,y,!0),setTimeout(function(){h.$el.css({top:"0px",zIndex:1e4})},10),g=h}b.pop()}else{var h=u[_];if(m>0&&!h.ignore_exist)h.$el.css({top:"0px"});else{var x=e.new_page_entity({custom_tansition:z,without_his:$}),C=x.view();C.$el.attr("page-url",_),C.$el.css({visibility:"hidden",top:"0px",zIndex:N}),N++,c(o).prepend(C.$el),h=C,u[_]=C,"function"==typeof C.page_init&&C.page_init.call(t,C,v,w)}p=g;var y=h.transition_type;a(p,h,y,!1),g=h,h.without_his?(f[f.length-1]=h,b[b.length-1]=_):(f.push(h),b.push(_))}"function"==typeof r&&r.call(t)}})}}),define("frame/view_scroll",["base_package","ua"],function(e,t){function i(e){var t=200,i=this;Math.abs(i.y);var n=a(e).height();a(e).find("[lazyload_src]").each(function(e,i){var o=a(i),s=o.position(),d=s.top,l=o.height();if(d+l>0&&n+t>d){var r=o.attr("lazyload_src");o.attr("src",r).removeAttr("lazyload_src")}})}{var a=e("zepto");e("ua")}t.new_scroll=function(t,n){var o=this;o.options=n;var n=o.options||{},s=n.view_height||"100%",d=n.use_lazyload||!1,l=n.scroll_end||function(){},r=n.scroll_start||function(){},_=null==n.hideScrollbar?!0:n.hideScrollbar;a(t).css("height",s+"px");var c=e("iScroll");a(t).css({position:"relative"});var m=new c(a(t)[0],{checkDOMChanges:!0,bounce:!1,hideScrollbar:_,useTransform:!0,useTransition:!1,zoom:!1,onScrollEnd:function(){"function"==typeof l&&l.call(this,t),d&&i.call(this,t)},onScrollStart:function(){"function"==typeof r&&r.call(this,t)}}),p={};return p.scroll_to=function(e){m?m.scrollTo(0,e,0):t[0].scrollTop=e},p.trigger_scrollend=function(){m&&m.options.onScrollEnd()},p}});
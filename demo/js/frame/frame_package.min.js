define("frame/page",["ua","base_package"],function(e,t){var i=e("zepto");e("ua"),e("hammer")(i),i(document.body).hammer({swipe_velocity:.2}),t.new_page=function(e){var t=this;return{route:e.route,view:function(){return t.new_view(e)}}},t.new_view=function(t){var i=e("backbone"),a=i.View.extend({tagName:"div",className:"apps_page",title:t.title,manual_title:t.manual_title,dom_not_cache:t.dom_not_cache,transition_type:t.transition_type,ignore_exist:t.ignore_exist,without_his:t.without_his||!1,initialize:function(){this.$el.append('<div class="tran_cover"></div>'),"function"==typeof t.initialize&&t.initialize.call(this)},open_cover:function(){this.$el.find(".tran_cover").show()},close_cover:function(){var e=this;setTimeout(function(){e.$el.find(".tran_cover").hide()},300)},events:t.events,render:t.render,page_show:t.page_show,page_before_show:t.page_before_show,page_back_show:t.page_back_show,page_init:t.page_init,window_change:t.window_change,page_before_hide:t.page_before_hide,page_hide:t.page_hide,page_lock:!1});return new a}}),define("frame/page_control",["base_package","ua"],function(e,t){function i(){var e=location.href,t=b.length;if(t>1){var i=b[t-2];return"forward"!=m&&i==e?!0:!1}return!1}function a(e,t,i,a){var o,s,d=this,l="400ms",r="400ms",_="400ms",c="ease";switch(I&&p.isAndroid&&(i="none"),"function"==typeof t.page_before_show&&t.page_before_show.call(d,t,v,w),e&&e.open_cover(),e&&"function"==typeof e.page_before_hide&&e.page_before_hide.call(d,e),i){case"slide":a?(o="slideinfromleft",s="slideoutfromright"):(o="slideinfromright",s="slideoutfromleft"),animation_timing_function=c,animation_duration=l;break;case"slide_reverse":a?(o="slideinfromleft",s="slideoutfromright"):(o="slideinfromleft",s="slideoutfromright"),animation_timing_function=c,animation_duration=l;break;case"slideup":a?(o="slideupinfromtop",s="slideupoutfrombottom"):(o="slideupinfrombottom",s="slideupoutfromtop"),animation_timing_function=c,animation_duration=r;break;case"fade":o="fadein",s="fadeout",animation_timing_function=c,animation_duration=_;break;default:o="none",s="none",animation_timing_function=c,animation_duration="10ms"}if(z=!0,o){var m=t.el;if(y=t,m.style.webkitAnimationDuration=animation_duration,m.style.webkitAnimationTimingFunction=animation_timing_function,m.style.visibility="visible",m.style.webkitAnimationName=o,e){var h=e.el;x=e,h.style.webkitAnimationDuration=animation_duration,h.style.webkitAnimationTimingFunction=animation_timing_function,h.style.webkitAnimationName=s}else z=!1;setTimeout(function(){y.close_cover(),"function"==typeof y.page_back_show&&k&&y.page_back_show.call(d,y,v,w),"function"==typeof y.page_show&&y.page_show.call(d,y,v,w),n()},parseInt(animation_duration))}}function n(){z=!1;var e=this,t=x.el;y.el,1!=y.manual_title&&(document.title=y.title?y.title:d),t&&(c(t).css({top:"-3000px"}),"function"==typeof x.page_hide&&x.page_hide.call(e),1==x.dom_not_cache&&k&&x&&x.remove(),y.without_his&&x&&x.remove()),h=null,m=null,k=null}var o,s,d,l,r,_=e("backbone"),c=e("zepto"),p=e("ua"),m=null,h=null,u={},f=[],g=null,v=[],b=[],w={},y={},x={},k=null,$=null,j=null,z=!1,C=!1,I=!0,q=_.Router.extend({}),T=new q;t.init=function(e,t){var i=this,t=t||{};s=t.default_index_route||"",d=t.default_title||"",l=t.before_route||"",r=t.after_route||"",o=e,s&&T.route("","",function(){i.navigate_to_page(s,{},!0)})},t.route_start=function(){_.history.start()},t.navigate_to_page=function(e,t,i,a){if(!z){w=t,m="forward";var i=null==i?!1:i;$=i,j=null==a?!1:a,T.navigate(e,{trigger:!0,replace:i})}},t.back=function(){if(!z){if(1>=f.length)return""!=s&&(this.navigate_to_page(s),setTimeout(function(){x.remove()},1e3)),!1;m="backward",window.history.back()}},t.page_history=function(){return b},t.window_change_page_triger=function(){"function"==typeof y.window_change&&y.window_change.call(this,y)},t.return_current_page_view=function(){return y},t.lock_page=function(){C=!0},t.unlock_page=function(){C=!1},t.page_lock_status=function(){return C},t.page_transit_status=function(){return z};var S=1e4;t.add_page=function(e){var t=this,n=e.route||{};for(key in n)T.route(key,n[key],function(n,s,d){if(!z){v=[],v.push(n),v.push(s),v.push(d);var _=location.href;"function"==typeof l&&l.call(t);var p=!1,p=c(o).find('[page-url="'+_+'"]').length;if(k=i()){f.pop();var m=g,h=f[f.length-1];if(p>0){var y=m.transition_type;a(m,h,y,!0),setTimeout(function(){h.$el.css({top:"0px",zIndex:1e4})},10),g=h}b.pop()}else{var h=u[_];if(p>0&&!h.ignore_exist)h.$el.css({top:"0px"});else{var x=e.new_page_entity({custom_tansition:j,without_his:$}),C=x.view();C.$el.attr("page-url",_),C.$el.css({visibility:"hidden",top:"0px",zIndex:S}),S++,c(o).prepend(C.$el),h=C,u[_]=C,"function"==typeof C.page_init&&C.page_init.call(t,C,v,w)}m=g;var y=h.transition_type;a(m,h,y,!1),g=h,h.without_his?(f[f.length-1]=h,b[b.length-1]=_):(f.push(h),b.push(_))}"function"==typeof r&&r.call(t)}})}}),define("frame/view_scroll",["base_package","ua"],function(e,t){function i(e){var t=200,i=this;Math.abs(i.y);var n=a(e).height();a(e).find("[lazyload_src]").each(function(e,i){var o=a(i),s=o.position(),d=s.top,l=o.height();if(d+l>0&&n+t>d){var r=o.attr("lazyload_src");o.attr("src",r).removeAttr("lazyload_src")}})}{var a=e("zepto");e("ua")}t.new_scroll=function(t,n){var o=this;o.options=n;var n=o.options||{},s=n.view_height||"100%",d=n.use_lazyload||!1,l=n.bounce||!1,r=n.scroll_end||function(){},_=n.scroll_start||function(){},c=n.scroll_move||function(){},p=n.scroll_refresh||function(){},m=n.top_offset?n.top_offset:0,h=null==n.hideScrollbar?!0:n.hideScrollbar;console.log(m),a(t).css("height",s+"px");var u=e("iScroll");a(t).css({position:"relative"});var f=new u(a(t)[0],{checkDOMChanges:!0,bounce:l,hideScrollbar:h,useTransform:!0,useTransition:!1,topOffset:m,zoom:!1,onScrollEnd:function(){"function"==typeof r&&r.call(this,t),d&&i.call(this,t)},onScrollStart:function(){"function"==typeof _&&_.call(this,t)},onScrollMove:function(){"function"==typeof c&&c.call(this,t)},onRefresh:function(){"function"==typeof p&&p.call(this,t)}}),g={};return g.scroll_to=function(e){f?f.scrollTo(0,e,0):t[0].scrollTop=e},g.trigger_scrollend=function(){f&&f.options.onScrollEnd()},g}}),"function"==typeof process_add&&process_add();